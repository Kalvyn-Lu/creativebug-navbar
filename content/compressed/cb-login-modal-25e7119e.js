cbEffects.registerEffect({selector:".js-login",bindFunc:attachLoginModalEffects,});cbEffects.registerEffect({selector:".js-login-form",bindFunc:attachLoginFormEffects,});function attachLoginModalEffects(b,c){var c=$(c);if(!c.hasClass("js-login-init")){var a=c.data("redirect-on-success")||$("#cb_login_modal_redirect_on_success").val();c.on("click",function(d){$("#cb_login_modal").modal("show");$("#cb_login_modal_email").focus();$("#cb_login_modal_redirect_on_success").val(a);ga("send","pageview",c.attr("href"));d.preventDefault()});c.addClass("js-login-init")}}function attachLoginFormEffects(a,b){var b=$(b);if(!b.hasClass("js-login-form-init")){b.on("submit",loginSubmitAjax);b.addClass("js-login-form-init")}}function loginSubmitAjax(b){var c=$(b.target);var f=c.find("#cb_login_modal_email").val();var i=c.find("#cb_login_modal_password").val();var g=c.find("#cb_login_modal_remember_me").val();var d=c.find("#cb_login_modal_redirect_on_success").val();var a=c.find("#cb_login_modal_source").val();var h=c.find("#cb_login_modal_type").val();var e=c.find("#cb_login_modal_slug").val();$.ajax({url:c.attr("action"),type:c.attr("method"),dataType:"json",xhrFields:{withCredentials:true},data:{email:f,password:i,remember_me:g,redirect_on_success:d,source:a,type:h,slug:e,format:"json",},error:function(j){c.find(".login-error").removeClass("hidden")},success:function(l,j,k){window.location.href=l.redirect_on_success||window.location.href},});b.preventDefault()};